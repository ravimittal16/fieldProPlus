<ion-view title="{{vm.barCodeData.barcodeDetails.barcodeName}}" cache-view="false" hide-back-button="true" view-title="{{vm.barCodeData.barcodeDetails.barcodeName}}">
  <ion-nav-buttons side="left">
    <button menu-toggle="left" class="button button-icon icon ion-navicon"></button>
  </ion-nav-buttons>
  <ion-content scroll="false">
    <div class="list padding-top" data-ng-if="vm.errors.length > 0">
      <div class="error">
        <ui class="list-unstyled">
          <li data-ng-repeat="error in vm.errors">{{::error}}</li>
        </ui>
      </div>
    </div>
    <ion-tabs class="tabs-dark tabs-icon-top">
      <ion-tab title="DESCRIPTION" icon-on="ion-ios-paper" icon-off="ion-ios-paper-outline">
        <ion-content>
          <div>
            <div class="padding">
              <span class="label label-success">{{::vm.barCodeData.barcodeDetails.barcodeName}}</span>
              <div class="padding-top">
                <h4 class="n-m-b">{{::vm.barCodeData.barcodeDetails.displayName}}</h4>
                <address data-on-tap="vm.tabs.desc.events.onAddressTapped()">
                  <p>
                    <strong>{{::vm.barCodeData.barcodeDetails.company_Name}}</strong>
                    <a>
                      <i class="icon ion-ios-location"></i></a>
                  </p>
                  <p>{{::vm.barCodeData.barcodeDetails.shipStreet}}</p>
                  <p>{{::vm.barCodeData.barcodeDetails.shipCity}},{{::vm.barCodeData.barcodeDetails.shipState}}&nbsp;{{::vm.barCodeData.barcodeDetails.shipZIP}}
                  </p>
                  <p>{{::vm.barCodeData.barcodeDetails.phone}}
                  </p>
                  <p data-ng-if="vm.barCodeData.barcodeDetails.contactInfo">Contact Info : <span>{{::vm.barCodeData.barcodeDetails.contactInfo}}</span></p>
                </address>
              </div>
            </div>
            <div class="list">
              <div class="item item-divider">
                Other Information
              </div>
              <div class="item">
                Order Create Date
                <span class="item-note text-dark f-z-15">
									<strong>{{::vm.barCodeData.barcodeDetails.date | date:'MM/dd/yyyy'}}</strong>
								</span>
              </div>
              <div class="item" data-ng-if="vm.barCodeData.barcodeDetails.excptns">
                Job Type
                <span class="item-note text-dark f-z-15">
									<strong>{{::vm.barCodeData.barcodeDetails.excptns}}</strong>
								</span>
              </div>
              <div class="item" data-ng-if="vm.barCodeData.barcodeDetails.priority">
                Priority
                <span class="item-note text-dark f-z-15">
									<strong>{{::vm.barCodeData.barcodeDetails.priority}}</strong>
								</span>
              </div>
              <div class="item" data-ng-if="vm.barCodeData.barcodeDetails.class_id">
                Class
                <span class="item-note text-dark f-z-15">
									<strong>{{::vm.barCodeData.barcodeDetails.class_id}}</strong>
								</span>
              </div>
              <div class="item" data-ng-if="vm.barCodeData.barcodeDetails.poNum">
                PO Number
                <span class="item-note text-dark f-z-15">
									<strong>{{::vm.barCodeData.barcodeDetails.poNum}}</strong>
								</span>
              </div>
              <label class="item item-input item-stacked-label">
								<span class="input-label">Work Description</span>
								<textarea cols="30" rows="5" data-ng-model="vm.barCodeData.barcodeDetails.comment_1" data-ng-change="vm.tabs.desc.events.onDescriptionOrResolutionChanged()" data-ng-model-options="{debounce:500}"></textarea>
							</label>
              <label class="item item-input item-stacked-label">
								<span class="input-label">Resolution / Work performed</span>
								<textarea  cols="30" rows="5" data-ng-model="vm.barCodeData.barcodeDetails.comment_2" data-ng-change="vm.tabs.desc.events.onDescriptionOrResolutionChanged()" data-ng-model-options="{debounce:500}"></textarea>
							</label>
              <label class="item item-input item-stacked-label">
								<span class="input-label">Comments</span>
								<textarea  cols="30" rows="5" data-ng-model="vm.barCodeData.barcodeDetails.comment_4" data-ng-change="vm.tabs.desc.events.onDescriptionOrResolutionChanged()" data-ng-model-options="{debounce:500}"></textarea>
							</label>
            </div>
          </div>
        </ion-content>
      </ion-tab>
      <ion-tab title="SCHEDULE" icon-on="ion-ios-clock" icon-off="ion-ios-clock-outline">
        <ion-content>
          <div class="card">
            <div class="item item-text-wrap">
              <p class="n-m-b"><strong>Schedule Start</strong></p>
              <p>{{vm.schedule.scheduledStartDateTime | date:'MM/dd/yyyy hh:mm a'}}</p>
              <p class="n-m-b"><strong>Schedule End</strong></p>
              <p>{{vm.schedule.scheduledFinishDateTime | date:'MM/dd/yyyy hh:mm a'}}</p>
            </div>
          </div>
          <div class="card">
            <div class="item item-divider">
              Current Schedule Details
              <a class="button pull-right button-small button-icon icon ion-android-more-vertical button-small item-divider-left-buttion"
                ng-if="vm.uiSettings.billingOption == 0" data-ng-click="vm.tabs.sch.events.onScheduleActionButtonClicked()"></a>
            </div>
            <div class="row" data-ng-if="vm.schedule.approve">
              <div class="alert alert-info">
                <span>This schedule has been approved and cannot be edited.</span>
              </div>
            </div>
            <div class="col-xs-12" data-ng-if="vm.uiSettings.timerEnabled && vm.uiSettings.billingOption == 0">
              <work-order-timer-component data-is-checked-in="vm.schedule.checkInStatus" data-is-checked-out="vm.schedule.checkOutStatus"
                data-schedule="vm.schedule"></work-order-timer-component>
            </div>
            <div class="list" ng-if="vm.uiSettings.billingOption == 0">
              <div>
                <div class="button-bar padding button-bar-with-margin">
                  <button type="button" class="button button-small button-positive" data-ng-disabled="vm.schedule.approve || vm.schedule.checkInStatus"
                    data-ng-click="vm.tabs.sch.events.checkIn()">
                  <i class="ion ion-clock"></i>&nbsp;Check In
                </button>
                  <button type="button" class="button button-small button-positive" data-ng-disabled="vm.schedule.approve || vm.schedule.checkOutStatus"
                    data-ng-click="vm.tabs.sch.events.checkOut()">
                  <i class="ion ion-clock"></i>&nbsp;Check Out
                </button>
                </div>
                <label class="item item-input">
				        <span class="input-label">Actual Start Time</span>
								<input type="text" data-ng-if="!vm.schedule.approve" class="transparent-background text-right" data-mobiscroll-datetime="{display: 'bottom', dateFormat: 'mm/dd/yy', timeFormat: 'hh:ii A',onSelect:vm.scheduleTimeSpan.onStartDateTimeChaged}" data-ng-model="vm.schedule.actualStartDateTime"/>
								<input type="text" data-ng-if="vm.schedule.approve"  class="transparent-background text-right" disabled data-ng-model="vm.schedule.actualStartDateTime"/>
							</label>
                <label class="item item-input">
				        <span class="input-label">Actual Finish Time</span>
								<input type="text" data-ng-if="!vm.schedule.approve" class="transparent-background text-right" data-mobiscroll-datetime="{display: 'bottom', dateFormat: 'mm/dd/yy', timeFormat: 'hh:ii A',onSelect:vm.scheduleTimeSpan.onEndDateTimeChanged}" data-ng-model="vm.schedule.actualFinishDateTime"/>
								<input type="text" data-ng-if="vm.schedule.approve"  class="transparent-background text-right" disabled  data-ng-model="vm.schedule.actualFinishDateTime"/>
							</label>
                <label class="item item-input">
				      <span class="input-label">Total Time</span>
								<input type="text" data-ng-if="!vm.schedule.approve" class="transparent-background text-right" placeholder="Total Time" data-mobiscroll-timespan="{display: 'bottom',preset:'timespan',wheelOrder: 'hhii',onSelect:vm.scheduleTimeSpan.onTimespanSeletionChanged}" data-ng-model="vm.scheduleTimeSpan.timeSpan"/>
								<input type="text" data-ng-if="vm.schedule.approve"  class="transparent-background text-right" disabled placeholder="Total Time" data-ng-model="vm.scheduleTimeSpan.timeSpan"/>
							</label>
                <div class="padding" data-ng-if="vm.uiSettings.isTimeCardModuleEnabled">
                  <button class="button button-block button-small button-dark" data-ng-click="vm.tabs.sch.events.pushToTimecard()">
                  <i class="ion ion-clock"></i>&nbsp;Push to Timecard
                </button>
                </div>
              </div>
              <div ng-if="vm.uiSettings.billingOption == 0 && vm.uiSettings.isRouteTimeOptionChecked">
                <div class="item item-divider">
                  In Route Details
                </div>
                <label class="item item-input">
                  <span class="input-label">In Route Start</span>
                  <input type="text" data-ng-if="!vm.schedule.approve" class="transparent-background text-right" data-mobiscroll-datetime="{display: 'bottom', dateFormat: 'mm/dd/yy', timeFormat: 'hh:ii A',onSelect:vm.scheduleTimeSpan.onInRouteTImeChanged}" data-ng-model="vm.schedule.inRouteStartTime"/>
                  <input type="text" data-ng-if="vm.schedule.approve"  class="transparent-background text-right" disabled data-ng-model="vm.schedule.inRouteStartTime"/>
							</label>
                <label class="item item-input">
                  <span class="input-label">In Route End</span>
                  <input type="text" data-ng-if="!vm.schedule.approve" class="transparent-background text-right" data-mobiscroll-datetime="{display: 'bottom', dateFormat: 'mm/dd/yy', timeFormat: 'hh:ii A',onSelect:vm.scheduleTimeSpan.onInRouteTImeChanged}" data-ng-model="vm.schedule.inRouteEndTime"/>
                  <input type="text" data-ng-if="vm.schedule.approve"  class="transparent-background text-right" disabled  data-ng-model="vm.schedule.inRouteEndTime"/>
							</label>
                <label class="item item-input">
                    <span class="input-label">Total Time</span>
                    <input type="text" data-ng-if="!vm.schedule.approve" class="transparent-background text-right" placeholder="Total Time" data-mobiscroll-timespan="{display: 'bottom',preset:'timespan',wheelOrder: 'hhii',onSelect:vm.scheduleTimeSpan.onInRouteTimespanChanged}" data-ng-model="vm.scheduleTimeSpan.inRouteTimeSpan"/>
                    <input type="text" data-ng-if="vm.schedule.approve"  class="transparent-background text-right" disabled placeholder="Total Time" data-ng-model="vm.scheduleTimeSpan.inRouteTimeSpan"/>
                  </label>
              </div>
              <label class="item item-input">
								<textarea name="" id="" rows="6" placeholder="enter trip note here..." data-ng-model="vm.schedule.tripNote" data-ng-change="vm.tabs.sch.events.onTripnoteChanged()" data-ng-model-options="{debounce:500}"></textarea>
							</label>
            </div>
            <div class="list" ng-if="vm.uiSettings.billingOption == 1">
              <label class="item item-input">
				        <span class="input-label">Actual Start Date</span>
								<input type="text" data-ng-if="!vm.schedule.approve" class="transparent-background text-right" data-mobiscroll-date="{display: 'bottom', dateFormat: 'mm/dd/yy',onSelect:vm.scheduleTimeSpan.onStartDateTimeChaged}" data-ng-model="vm.schedule.actualStartDateTime"/>
								<input type="text" data-ng-if="vm.schedule.approve"  class="transparent-background text-right" disabled data-ng-model="vm.schedule.actualStartDateTime"/>
							</label>

              <label class="item item-input" data-ng-repeat="cs in ::vm.schedule.customSchedules">
                <span class="input-label">{{::cs.fieldGivenName}}</span>
                <input type="text" data-ng-if="!vm.schedule.approve" class="transparent-background text-right" data-mobiscroll-numpad="{display: 'bottom',min:0,scale: 2,max:99999.99,preset:'decimal'}" data-ng-model="cs.totalHours" data-ng-change="vm.tabs.sch.events.onCustomScheduleChanged(cs)"/>
								<input type="text" data-ng-if="vm.schedule.approve"  class="transparent-background text-right" disabled data-ng-model="cs.totalHours"/>
              </label>


              <label class="item item-input">
                  <textarea name="" id="" rows="6" placeholder="enter trip note here..." data-ng-model="vm.schedule.tripNote" data-ng-change="vm.tabs.sch.events.onTripnoteChanged()" data-ng-model-options="{debounce:500}"></textarea>
                </label>
            </div>
          </div>
          <div class="card" data-ng-if="vm.uiSettings.milageTrackingEnabled">
            <div class="item item-divider">
              Milage Information
              <!--<a class="button pull-right button-small button-icon icon ion-android-more-vertical button-small item-divider-left-buttion"
                data-ng-click="vm.tabs.sch.events.onMilageInformationActionButtonClicked()"></a>-->
            </div>
            <div class="list">
              <label class="item item-input item-select">
								<div class="input-label">
									Vehicle Number
								</div>
								<select data-ng-model="vm.schedule.numFromVehicles" data-ng-change="vm.tabs.sch.events.updateMilage()" data-ng-options="p.num as p.vehicleNumber for p in vm.vehicles"><select>
							</label>
              <label class="item item-input">
								<span class="input-label">Start (Miles)</span>
								<input type="text" class="transparent-background" data-mobiscroll-numpad="{display: 'bottom',min:0,scale: 0,max:99999.99,preset:'decimal',onSelect:vm.tabs.sch.events.updateMilage}" data-ng-model="vm.schedule.startMiles" data-ng-change="vm.schedule.totalMiles = vm.schedule.endMiles - vm.schedule.startMiles" />
							</label>
              <label class="item item-input">
									<span class="input-label">End</span>
									<input type="text" class="transparent-background" data-mobiscroll-numpad="{display: 'bottom',min:0,scale: 0,max:99999,preset:'decimal',onSelect:vm.tabs.sch.events.updateMilage}" data-ng-model="vm.schedule.endMiles" data-ng-change="vm.schedule.totalMiles = vm.schedule.endMiles - vm.schedule.startMiles"/>
							</label>
              <label class="item item-input">
									<span class="input-label"><strong>Total</strong></span>
									<input type="text" readonly="" class="transparent-background" data-ng-model="vm.schedule.totalMiles"/>
							</label>
            </div>
          </div>
          <div class="card">
            <div class="item item-divider">
              Other Schedules
              <!--<a class="button pull-right button-small button-icon icon ion-android-more-vertical button-small item-divider-left-buttion"
                data-ng-click="vm.tabs.sch.events.onSchedulesListButtonClicked()"></a>-->
            </div>
            <div class="padding-left padding-right">
              <button class="button button-block button-small button-positive" data-ng-click="vm.tabs.sch.events.onSchedulesListButtonClicked()">
                  <i class="ion ion-plus"></i>&nbsp;Add New Schedule
                </button>
            </div>
            <ion-list>
              <ion-item class="item-text-wrap" data-ng-repeat="sch in vm.barCodeData.schedules" data-ng-click="vm.tabs.sch.events.onListScheduleItemTap(sch)"
                data-ng-class="{'active':vm.schedule.num === sch.num}">
                <h4><span class="text-muted">Sch Date :</span> <strong>{{::sch.scheduledStartDateTime | date:'MM/dd/yyyy'}}</strong>&nbsp;
                  <span class="text-muted" data-ng-if="sch.actualStartDateTime">Actual Date : </span><strong data-ng-if="sch.actualStartDateTime">
									{{::sch.actualStartDateTime | date:'MM/dd/yyyy'}}
								</strong>
                  <strong class="text-info">{{::sch.technicianName}}</strong><span data-ng-if="sch.tripNote">: Trip Note - {{::sch.tripNote}}</span></h4>
              </ion-item>
            </ion-list>
          </div>
        </ion-content>
      </ion-tab>
      <ion-tab title="PRODUCTS" icon-on="ion-ios-list" icon-off="ion-ios-list-outline">
        <ion-content>
          <ion-list can-swipe="true">
            <div class="item item-divider">
              Products selected for Work Order
              <a class="button pull-right button-small button-icon icon ion-android-more-vertical button-small item-divider-left-buttion"
                data-ng-click="vm.tabs.prod.events.onProdcutActionButtonClicked()"></a>
            </div>
            <ion-item class="item-text-wrap p-10" data-ng-repeat="p in vm.barCodeData.products">
              <div class="row">
                <div class="col col-50">
                  <h3>{{::p.productName}}</h3>
                </div>
                <div class="col col-25">
                  <h4 class="pull-right"><strong>{{p.qty}}</strong></h4>
                </div>
                <div class="col  col-25 text-right">
                  <h3 class="pull-right" data-ng-if="vm.user.showPrice"><strong>{{p.price | currency:'$':2}}</strong></h4>
                </div>
              </div>
              <div class="row n-p-t n-p-b row-top">
                <div class="col">
                  <small class="text-muted text-small">{{p.productDescription}}<small>
								</div>
							</div>
							 <ion-option-button class="button-assertive" ng-click="vm.tabs.prod.events.onDeleteProductClicked(p)">
								Delete
							</ion-option-button>
							<ion-option-button class="button-info" data-ng-if="!vm.isServiceProvider || sch.technicianNum == vm.userId" ng-click="vm.tabs.prod.events.onEditProductClicked(p)">
								Edit
							</ion-option-button>
						</ion-item>
						
					</ion-list>
				</ion-content>
			</ion-tab>
			<ion-tab title="COMPONENTS" icon-on="ion-ios-cog" icon-off="ion-ios-cog-outline">
        <ion-content>
          <jobtype-list-component data-barcode="vm.barcode" data-jobtype="vm.barCodeData.barcodeDetails.excptns"></jobtype-list-component>
          <equipments-list-component data-ng-if="vm.uiSettings.showEquipmentTabControl" 
          data-barcode="vm.barcode" uin="vm.barCodeData.barcodeDetails.uin" display-name="vm.barCodeData.barcodeDetails.displayName"></equipments-list-component>
          <expanse-expander-component data-barcode="vm.barcode"></expanse-expander-component>
        </ion-content>
			</ion-tab>
			<ion-tab title="SUMMARY" icon-on="ion-ios-calculator" icon-off="ion-ios-calculator-outline">
				<ion-content>
					<ion-list>
						<div>
							<ion-item class="item-stable" ng-click="vm.invoiceOpen = !vm.invoiceOpen" ng-class="{active: vm.invoiceOpen}">
								<i class="icon" ng-class="vm.invoiceOpen ? 'ion-minus' : 'ion-plus'"></i> &nbsp; <strong>Invoice Details</strong>
							</ion-item>
							<div data-ng-if="vm.invoiceOpen">
								<ion-list>
										<div class="item item-divider">
											<div class="row">
												<div class="col col-50">Name</div>
												<div class="col col-10" data-ng-if="vm.taxCheckboxVisibility">Tax</div>
												<div class="col col-20 text-center">Qty</div>
												<div class="col col-20">
													<span class="pull-right">Total</span>
												</div>
											</div>
										</div>
									<ion-item data-ng-repeat="inv in vm.barCodeData.invoice" class="item-text-wrap">
										<div class="row">
											<div class="col col-50">
												<h3>{{::inv.productName}}</h3>
											</div>
											<div class="col col-10" data-ng-if="vm.taxCheckboxVisibility">
												<input type="checkbox" data-ng-model="inv.taxable" data-ng-change="vm.tabs.smry.events.onTaxCheckboaxChanged(inv)"/>
											</div>
											<div class="col col-20 text-center">
												<h3>{{inv.qty || 0}}</h3>
											</div>
											<div class="col col-20">
												<h3 class="pull-right" data-ng-if="vm.user.showPrice">{{inv.totalPrice | currency:'$':2}}</h3>
											</div>
										</div>
									</ion-item>
								</ion-list>
							</div>
						</div>
					</ion-list>
					<div class="row" data-ng-if="vm.user.showPrice">
						<div class="col">
							<p>
								<h5>Subtotal
									<span class="pull-right">{{vm.totals.subtotal | currency:'$':2}}</span>
								</h5>
							</p>
							<p>
								<h5>Total Tax
									<span class="pull-right text-muted">{{vm.totals.totaltax | currency:'$':2}}</span>
								</h5>
							</p>
							<p>
								<h5>Total Amount
									<span class="pull-right text-energized">{{vm.totals.subtotal + vm.totals.totaltax | currency:'$':2}}</span>
								</h5>
							</p>
						</div>
					</div>
					<order-signature-component data-barcode="vm.barcode"></order-signature-component>
					<order-email-card-component data-barcode="vm.barcode" data-taxrate="vm.barCodeData.taxRate" data-default-emails="vm.barCodeData.barcodeDetails.address2_Group"></order-email-card-component>
					<order-images-list-component data-barcode="vm.barcode"></order-images-list-component>
					<order-documents-list-component data-barcode="vm.barcode"></order-documents-list-component>
					<div class="list">
							<label class="item item-input item-select">
								<div class="input-label">
									Secondary Order Status
								</div>
								<select data-ng-model="vm.barCodeData.barcodeDetails.secondaryOrderStatus" data-ng-options="p.statusId as p.statusName for p in vm.scheduleStatus" data-ng-change="vm.tabs.desc.events.onDescriptionOrResolutionChanged()"><select>
							</label>				
							 <ion-toggle ng-model="vm.schedule.workComplete" toggle-class="toggle-balanced" data-ng-change="vm.tabs.sch.events.updateSchedule()">Work Complete</ion-toggle>				
					</div>
				</ion-content>
			</ion-tab>
		</ion-tabs>
	</ion-content>
</ion-view>
<script id="editProductModal.html" type="text/ng-template">
	<ion-modal-view>
		<edit-product-component is-estimate="false" data-modal-type="0" data-product="vm.currentProduct" 
    data-enable-markup-orders="vm.enableMarkup"></edit-product-component>
	</ion-modal-view>
</script>

<script id="addProductModal.html" type="text/ng-template">
	<ion-modal-view>
		<edit-product-component is-estimate="false" data-modal-type="1" 
		data-product="vm.currentProduct" data-on-add-product-completed="vm.events.onAddProductCompleted(product)" 
    data-enable-markup-orders="vm.enableMarkup"></edit-product-component>
	</ion-modal-view>
</script>
<script id="workOrderMap.html" type="text/ng-template">
    <ion-modal-view>
      <ion-header-bar>
            <h1 class="title">
                {{::vm.barCodeData.barcodeDetails.barcodeName}} 
            </h1>
            <button type="button" class="button button-small button-light" data-ng-click="vm.tabs.desc.events.closeWorkOrderMapModal()">
                Close
            </button>
        </ion-header-bar>
        <ion-content>
          <div id="map" style="height:100%;width:100%;" data-tap-disabled="true"></div>
        </ion-content>
    </ion-modal-view>  
</script>